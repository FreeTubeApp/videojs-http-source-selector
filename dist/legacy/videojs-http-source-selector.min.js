!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["videojs-http-source-selector"]=t(e.videojs)}(this,function(u){"use strict";function n(e,t){e.prototype=Object.create(t.prototype),r(e.prototype.constructor=e,t)}function r(e,t){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){var n,r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){var n;if(e)return"string"==typeof e?o(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return r&&(e=r),n=0,function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var e=u.getComponent("MenuItem"),t=u.getComponent("Component"),c=function(i){function e(e,t){return t.selectable=!0,t.multiSelectable=!1,i.call(this,e,t)||this}n(e,i);var t=e.prototype;return t.handleClick=function(){for(var e=this.options_,t=(i.prototype.handleClick.call(this),[].concat(this.player_.qualityLevels().levels_)),n=s(t.entries());!(r=n()).done;){var r=r.value,o=r[0];r[1].enabled=e.index===t.length||e.index===o}},t.update=function(){var e=this.player_.qualityLevels().selectedIndex;this.selected(this.options_.index===e)},e}(e),i=(t.registerComponent("SourceMenuItem",c),u.getComponent("MenuButton")),l=function(a){function e(e,t){var e=a.call(this,e,t)||this,n=e.player_.qualityLevels();if(t&&t.default)if("low"===t.default)for(var r=s(n.entries());!(o=r()).done;){var o=o.value,i=o[0];o[1].enabled=0===i}else if("high"===t.default)for(var l=0;l<n.length;l++)n[l].enabled=l===n.length-1;return e.player_.qualityLevels().on(["change","addqualitylevel"],u.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e),e.update)),e}n(e,a);var t=e.prototype;return t.createEl=function(){return u.dom.createEl("div",{className:"vjs-http-source-selector vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})},t.buildCSSClass=function(){return i.prototype.buildCSSClass.call(this)},t.update=function(){return i.prototype.update.call(this)},t.createItems=function(){for(var e=[],t=this.player_.qualityLevels(),n=[],r=t.length-1;0<=r;r--){var o=r===t.selectedIndex,i=""+r,l=r,a=t[r];a.height?(i=a.height+"p",l=Number.parseInt(a.height,10)):a.bitrate&&(i=Math.floor(a.bitrate/1e3)+" kbps",l=Number.parseInt(a.bitrate,10)),n.includes(i)||(n.push(i),e.push(new c(this.player_,{label:i,index:r,selected:o,sortValue:l})))}return 1<t.length&&e.push(new c(this.player_,{label:"Auto",index:t.length,selected:!1,sortValue:99999})),e.sort(function(e,t){return t.options_.sortValue-e.options_.sortValue}),e},e}(i),a={},e=function(o){function e(e,t){u.registerComponent("SourceMenuButton",l),u.registerComponent("SourceMenuItem",c);var n,r=((null==u||null==(r=u.obj)?void 0:r.merge)||u.mergeOptions)(a,t);return(n=o.call(this,e,r)||this).options_=r,n.player_=e,n.on(e,"ready",function(){n.init()}),n}n(e,o);var t=e.prototype;return t.init=function(){var e=this;this.reset(),this.player_.addClass("vjs-http-source-selector"),this.player_.videojsHTTPSouceSelectorInitialized=!0,"Html5"===this.player_.techName_?this.on(this.player_,"loadedmetadata",function(){e.metadataLoaded()}):(console.error(this.player_.techName_+" tech is not supported"),this.reset())},t.reset=function(){this.player_.removeClass("vjs-http-source-selector"),!0===this.player_.videojsHTTPSouceSelectorInitialized&&(this.player_.controlBar.getChild("SourceMenuButton")||this.player_.controlBar.removeChild("SourceMenuButton",{}),this.player_.videojsHTTPSouceSelectorInitialized=!1)},t.metadataLoaded=function(){this.init();var e=this.player_.controlBar,t=e.getChild("fullscreenToggle");e.getChild("SourceMenuButton")||(t?e.el().insertBefore(e.addChild("SourceMenuButton").el(),t.el()):e.el().append(e.addChild("SourceMenuButton").el()))},e}(u.getPlugin("plugin"));return(0,u.registerPlugin)("httpSourceSelector",e),e.VERSION="1.1.7",e});
//# sourceMappingURL=videojs-http-source-selector.min.js