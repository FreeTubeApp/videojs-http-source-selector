//! videojs-http-source-selector v1.1.7 ~~ https://github.com/FreeTubeApp/videojs-http-source-selector ~~ MIT License
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["videojs-http-source-selector"]=t(e.videojs)}(this,function(r){"use strict";var e=r.getComponent("MenuItem"),t=r.getComponent("Component");class a extends e{constructor(e,t){t.selectable=!0,t.multiSelectable=!1,super(e,t)}handleClick(){var e,t,s=this.options_,o=(super.handleClick(),[...this.player_.qualityLevels().levels_]);for([e,t]of o.entries())t.enabled=s.index===o.length||s.index===e}update(){var e=this.player_.qualityLevels().selectedIndex;this.selected(this.options_.index===e)}}t.registerComponent("SourceMenuItem",a);const s=r.getComponent("MenuButton");class o extends s{constructor(e,t){super(e,t);var s=this.player_.qualityLevels();if(t&&t.default)if("low"===t.default)for(var[o,l]of s.entries())l.enabled=0===o;else if("high"===t.default)for(let e=0;e<s.length;e++)s[e].enabled=e===s.length-1;this.player_.qualityLevels().on(["change","addqualitylevel"],r.bind(this,this.update))}createEl(){return r.dom.createEl("div",{className:"vjs-http-source-selector vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})}buildCSSClass(){return s.prototype.buildCSSClass.call(this)}update(){return s.prototype.update.call(this)}createItems(){var o=[],l=this.player_.qualityLevels(),r=[];for(let s=l.length-1;0<=s;s--){var i=s===l.selectedIndex;let e=""+s,t=s;var n=l[s];n.height?(e=n.height+"p",t=Number.parseInt(n.height,10)):n.bitrate&&(e=Math.floor(n.bitrate/1e3)+" kbps",t=Number.parseInt(n.bitrate,10)),r.includes(e)||(r.push(e),o.push(new a(this.player_,{label:e,index:s,selected:i,sortValue:t})))}return 1<l.length&&o.push(new a(this.player_,{label:"Auto",index:l.length,selected:!1,sortValue:99999})),o.sort(function(e,t){return t.options_.sortValue-e.options_.sortValue}),o}}const l={};class i extends r.getPlugin("plugin"){constructor(e,t){r.registerComponent("SourceMenuButton",o),r.registerComponent("SourceMenuItem",a);t=(r?.obj?.merge||r.mergeOptions)(l,t);super(e,t),this.options_=t,this.player_=e,this.on(e,"ready",()=>{this.init()})}init(){this.reset(),this.player_.addClass("vjs-http-source-selector"),this.player_.videojsHTTPSouceSelectorInitialized=!0,"Html5"===this.player_.techName_?this.on(this.player_,"loadedmetadata",()=>{this.metadataLoaded()}):(console.error(this.player_.techName_+" tech is not supported"),this.reset())}reset(){this.player_.removeClass("vjs-http-source-selector"),!0===this.player_.videojsHTTPSouceSelectorInitialized&&(this.player_.controlBar.getChild("SourceMenuButton")||this.player_.controlBar.removeChild("SourceMenuButton",{}),this.player_.videojsHTTPSouceSelectorInitialized=!1)}metadataLoaded(){this.init();var e=this.player_.controlBar,t=e.getChild("fullscreenToggle");e.getChild("SourceMenuButton")||(t?e.el().insertBefore(e.addChild("SourceMenuButton").el(),t.el()):e.el().append(e.addChild("SourceMenuButton").el()))}}return(0,r.registerPlugin)("httpSourceSelector",i),i.VERSION="1.1.7",i});
//# sourceMappingURL=videojs-http-source-selector.min.js
